<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>iOS9新特性の3D-touch-上篇 | crossPQW</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="iPhone6s&amp;amp;iPhone 6s plus发布也有一段时间了,最大的亮点应该就是3D-touch毋庸置疑了,第一时间体验了之后最大的感受就是苹果爸爸太给力了…….事实上我也从未见过第二家公司能把科技与易用性结合的如此天衣无缝的,当年5s指纹识别如此,今年的3D-touch亦如此.苹果也开放了相关的api,作为一个开发者怎能不第一时间在自己的应用上面集成这个好玩的特性呢.  应用中使用">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS9新特性の3D-touch-上篇">
<meta property="og:url" content="http://yoursite.com/2016/04/15/iOS9新特性の3D-touch-上篇/index.html">
<meta property="og:site_name" content="crossPQW">
<meta property="og:description" content="iPhone6s&amp;amp;iPhone 6s plus发布也有一段时间了,最大的亮点应该就是3D-touch毋庸置疑了,第一时间体验了之后最大的感受就是苹果爸爸太给力了…….事实上我也从未见过第二家公司能把科技与易用性结合的如此天衣无缝的,当年5s指纹识别如此,今年的3D-touch亦如此.苹果也开放了相关的api,作为一个开发者怎能不第一时间在自己的应用上面集成这个好玩的特性呢.  应用中使用">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/290760-f9e486885307b47e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/290760-219f269a051fe040.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2017-12-14T15:17:18.039Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS9新特性の3D-touch-上篇">
<meta name="twitter:description" content="iPhone6s&amp;amp;iPhone 6s plus发布也有一段时间了,最大的亮点应该就是3D-touch毋庸置疑了,第一时间体验了之后最大的感受就是苹果爸爸太给力了…….事实上我也从未见过第二家公司能把科技与易用性结合的如此天衣无缝的,当年5s指纹识别如此,今年的3D-touch亦如此.苹果也开放了相关的api,作为一个开发者怎能不第一时间在自己的应用上面集成这个好玩的特性呢.  应用中使用">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/290760-f9e486885307b47e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternative" href="/atom.xml" title="crossPQW" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">crossPQW</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
	</div>
</header>
    <div id="main">
      <article id="post-iOS9新特性の3D-touch-上篇" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/2016/04/15/iOS9新特性の3D-touch-上篇/" class="article-date">
  <time datetime="2016-04-15T07:34:35.000Z" itemprop="datePublished">2016-04-15</time>
</a>
		</span>
		<span class="meta-elements author">黄少华</span>
		<div class="commentscount">
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 class="article-title entry-title" itemprop="name">
      iOS9新特性の3D-touch-上篇
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<blockquote>
<p>iPhone6s&amp;iPhone 6s plus发布也有一段时间了,最大的亮点应该就是3D-touch毋庸置疑了,第一时间体验了之后最大的感受就是苹果爸爸太给力了…….事实上我也从未见过第二家公司能把科技与易用性结合的如此天衣无缝的,当年5s指纹识别如此,今年的3D-touch亦如此.苹果也开放了相关的api,作为一个开发者怎能不第一时间在自己的应用上面集成这个好玩的特性呢.</p>
</blockquote>
<p>应用中使用3Dtouch有两种方式:  </p>
<ul>
<li>第一种是按压图标启动应用的时候,类似于pc上面的右键,但是又不同于右键,我们可以把它理解为一个快速入口,能够有效的减少用户的操作量.这里我们只能使用轻按手势<code>shortCut</code>.  </li>
<li>第二种则是应用内的集成了,比如短信列表我们可以轻按预览短信内容,发现感兴趣的话再稍微用力进入详情页面,事实上目前大多数集成了3Dtouch的app也大多数是应用在这个使用场景,即在list-detail之间加了一层预览,变成了list-preview-detail.</li>
</ul>
<p>上篇先写一下第一种场景如何集成.<br>这时候我们的所有代码都是在app delegate里面完成的,当然我们也可以写一个分类方便给app delegate瘦身.</p>
<h6 id="在app-delegate的代理方法didFinishLaunchingWithOptions里面做如下操作"><a href="#在app-delegate的代理方法didFinishLaunchingWithOptions里面做如下操作" class="headerlink" title="在app delegate的代理方法didFinishLaunchingWithOptions里面做如下操作:"></a>在app delegate的代理方法didFinishLaunchingWithOptions里面做如下操作:</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ///setup icons</span><br><span class="line">    UIApplicationShortcutIcon *icon1 = [UIApplicationShortcutIcon iconWithType:UIApplicationShortcutIconTypeCompose];</span><br><span class="line">    UIApplicationShortcutIcon *icon2 = [UIApplicationShortcutIcon iconWithType:UIApplicationShortcutIconTypeLocation];</span><br><span class="line">    UIApplicationShortcutIcon *icon3 = [UIApplicationShortcutIcon iconWithType:UIApplicationShortcutIconTypePause];</span><br><span class="line">    UIApplicationShortcutIcon *icon4 = [UIApplicationShortcutIcon iconWithTemplateImageName:@&quot;favicon.png&quot;];</span><br><span class="line">    </span><br><span class="line">    ///setup items</span><br><span class="line">    UIMutableApplicationShortcutItem *item1 = [[UIMutableApplicationShortcutItem alloc] initWithType:@&quot;first&quot; localizedTitle:@&quot;first item title&quot; localizedSubtitle:@&quot;first item detail title&quot; icon:icon1 userInfo:nil];</span><br><span class="line">    UIMutableApplicationShortcutItem *item2 = [[UIMutableApplicationShortcutItem alloc] initWithType:@&quot;second&quot; localizedTitle:@&quot;second item title&quot; localizedSubtitle:@&quot;second item detail title&quot; icon:icon2 userInfo:nil];</span><br><span class="line">    UIMutableApplicationShortcutItem *item3 = [[UIMutableApplicationShortcutItem alloc] initWithType:@&quot;third&quot; localizedTitle:@&quot;third item title&quot; localizedSubtitle:@&quot;third item detail title&quot; icon:icon3 userInfo:nil];</span><br><span class="line">    UIMutableApplicationShortcutItem *item4 = [[UIMutableApplicationShortcutItem alloc] initWithType:@&quot;forth&quot; localizedTitle:@&quot;forth item title&quot; localizedSubtitle:@&quot;forth item detail title&quot; icon:icon4 userInfo:nil];</span><br><span class="line">    </span><br><span class="line">    NSArray *items = @[item1,item2,item3,item4];</span><br><span class="line">    </span><br><span class="line">    [UIApplication sharedApplication].shortcutItems = items ;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    UIApplicationShortcutItem *item = [launchOptions valueForKey:UIApplicationLaunchOptionsShortcutItemKey];</span><br><span class="line">    if (item) &#123;</span><br><span class="line">        NSLog(@&quot;3d launch item is %@&quot;,item.localizedTitle);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        NSLog(@&quot;normal launch&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码还是非常简单的,就是创建四个图标,然后创建四个item,然后给shortcutItems赋值一个数组就可以了.<br>需要注意的是,使用了<code>iconWithTemplateImageName</code>方法创建的自定义的图标需要是正方形,单色,而且35*35point尺寸的,不然会显示下面效果图那种黑漆漆的效果.</p>
<blockquote>
<p>Icons should be square, single color, and 35x35 points  </p>
</blockquote>
<p>而我们如果想监听是从哪个item启动的应用,可以在以下方法里面操作:</p>
<pre><code>- (void)application:(UIApplication *)application performActionForShortcutItem:(UIApplicationShortcutItem *)shortcutItem completionHandler:(void (^)(BOOL))completionHandler
{
    NSLog(@&quot;selected item&apos;s title is %@&quot;,shortcutItem.description);
}
</code></pre><p>可以看到打印信息:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/290760-f9e486885307b47e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="6.jpg"><br>所以这里我们就可以通过shortcutItem.type来判断从哪个入口进入的了,所以我们在调用<code>- (instancetype _Nonnull)initWithType:(NSString * _Nonnull)type localizedTitle:(NSString * _Nonnull)localizedTitle localizedSubtitle:(NSString * _Nullable)localizedSubtitle icon:(UIApplicationShortcutIcon * _Nullable)icon userInfo:(NSDictionary * _Nullable)userInfo</code>初始化item的时候,可以自定义一个枚举来作为type参数,方便以后判断. </p>
<p>最终效果如下:  </p>
<p><img src="http://upload-images.jianshu.io/upload_images/290760-219f269a051fe040.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="7.jpg"><br><a href="https://github.com/crossPQW/3d-touch-demo" target="_blank" rel="noopener">你可以在这里下载这个demo</a></p>
<p><del>一个问题:<br>微信实现的图标居右是如何实现的呢?因为没有找到相关的api,难道是通过runtime来修改title跟icon的frame来做到的?</del><br>好傻逼的问题,突然发现图片左右是取决于图标在屏幕上的问题……..草草草草草</p>

    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
			</span>
		</div>
	</footer>
	
    
<nav id="article-nav">
  
    <a href="/2016/04/15/iOS9新特性の3D-touch-下篇/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          iOS9新特性の3D-touch-下篇
        
      </div>
    </a>
  
  
    <a href="/2016/04/07/使用CAAnimation打造一个有意思的loading动画/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          使用CAAnimation打造一个有意思的loading动画
        
      </div>
    </a>
  
</nav>

  
</article>




    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">crossPQW</a>
	</h1>
	<span class="copyright">
		&copy; 2017 黄少华<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>